.wrapper
  .form
    = form_for [@product] do |f|
      #image-box
        #previews
          - if @product.persisted?
            - @product.product_images.each_with_index do |image, i|
              = image_tag image.url, {data: {index: i}, width: "100", height: '100'}
        #img-fields
          = f.fields_for :product_images do |image| 
            = image.label :product_image, "出品画像"
            %span.attention 必須
            %div.js-file_group{data: {index: "#{image.index}"}}
              = image.file_field :url, class: "js-file", name: "product[product_images_attributes][#{image.index}][url]"
              %br
              %button{type: "button", class:'js-remove'}
                削除
              %br
          - if @product.errors[:product_images].present?
            = session[:error]
      %br
      =f.label :name, "商品名"
      %span.attention 必須
      =f.text_field :name, placeholder: "商品名", autofocus: 'true'
      = render partial: 'error-messages', locals: {product: f.object, column: 'name'}
      %br
      =f.label :description, "商品の説明"
      %span.attention 必須
      =f.text_area :description, placeholder: "商品の説明", autofocus: 'true'
      = render partial: 'error-messages', locals: {product: f.object, column: 'description'}
      %br
      .product-detail-info
        .product-detail-info__category
          =f.label :category, "カテゴリー", class: 'label'
          %span.attention 必須
          .category-select-wrapper
            .category-select-wrapper__box
              = select_tag 'parent_category', options_for_select(@category_parent.group_list.map(&:name), selected: @category_parent.name), class: 'category-select-wrapper__box__select', id: 'parent_category'
              %i.fas.fa-chevron-down.category-select-wrapper__box--arrow-signal
          .category-select-wrapper#children_wrapper
            .category-select-wrapper__box
              = select_tag 'child_category', options_for_select(@category_child.group_list.map(&:name), selected: @category_child.name), class: 'category-select-wrapper__box__select', id: 'child-category'
              %i.fas.fa-chevron-down.category-select-wrapper__box--arrow-signal
          .category-select-wrapper#grandchildren_wrapper
            .category-select-wrapper__box
              = f.collection_select :category_id, @category_grandchild.group_list, :id, :name, prompt: "選択して下さい", class: 'category-select-wrapper__box__select', id: 'grandchild-category'
              %i.fas.fa-chevron-down.category-select-wrapper__box--arrow-signal
              = render partial: 'error-messages', locals: {product: f.object, column: 'category'}
        .product-detail-info__category#size_wrapper
          = f.label :size, "サイズ", class: 'size_label'
          %span.attention 必須
          .size-select-wrapper
            .size_select-wrapper__box
              = f.collection_select :size_id, @product.size.group_list, :id, :size, prompt: '選択して下さい', class: 'category-select-wrapper__box__select', id: 'size'
              %i.fas.fa-chevron-down.category-select-wrapper__box--arrow-signal
      %br
      =f.label :brand, "ブランド ", class: 'label'
      =f.text_field :brand, placeholder: 'ブランド', autofocus: 'true'
      %br
      =f.label :product_condition, "商品の状態"
      %span.attention 必須
      =f.collection_select(:product_condition_id, ProductCondition.all, :id, :product_condition, prompt: "選択して下さい")
      = render partial: 'error-messages', locals: {product: f.object, column: 'product_condition_id'}
      %br
      .derivery-detail-info
        .derivery-detail-info__wrapper
          =f.label :derivery_fee_payer, "配送料の負担", class: 'label'
          %span.attention 必須
          =f.collection_select(:derivery_fee_payer_id, DeriveryFeePayer.all, :id, :derivery_fee_payer, prompt: "選択して下さい")
          = render partial: 'error-messages', locals: {product: f.object, column: 'derivery_fee_payer_id'}
          %br
          =f.label :derivery_method, "発送方法"
          %span.attention 必須
          =f.collection_select(:derivery_method_id, DeriveryMethod.all, :id, :name, prompt: "選択して下さい")
          %br
          =f.label :ship_from_location, "発送元の地域"
          %span.attention 必須
          =f.collection_select(:ship_from_location_id, ShipFromLocation.all, :id, :name, prompt: "選択して下さい")
          = render partial: 'error-messages', locals: {product: f.object, column: 'ship_from_location_id'}
          %br
          =f.label :derivery_day, "発送までの日数"
          %span.attention 必須
          =f.collection_select(:derivery_day_id, DeriveryDay.all, :id, :derivery_day, prompt: "選択して下さい")
          = render partial: 'error-messages', locals: {product: f.object, column: 'derivery_day_id'}
      %br

      =f.label :price, "販売価格"
      %span.attention 必須
      =f.number_field :price, autofocus: 'true'
      = render partial: 'error-messages', locals: {product: f.object, column: 'price'}
      %br
      =f.hidden_field :product_status_id, :value => 1
      =f.submit '出品する'


